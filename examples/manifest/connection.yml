# We can name this 'connection.yml' meaning connection configurations.

common:
  _store:
    client: InMemory
    key: 'connection.common'
  _load:
    client: Env
    map:
      host: 'DB_HOST'
      port: 'DB_PORT'
      database: 'DB_DATABASE'
      username: 'DB_USERNAME'
      password: 'DB_PASSWORD'

  name: 'common'
  driver: 'postgres'
  charset: 'UTF8'

  host:
    _state:
      type: string
  port:
    _state:
      type: integer
  database:
    _state:
      type: string
  username:
    _state:
      type: string
  password:
    _state:
      type: string

tenant:
  _store:
    client: InMemory
    key: 'connection.tenant${cache.user.tenant_id}'
  _load:
    client: DB
    connection: ${connection.common}
    table: 'tenants'
    where: 'id=${cache.user.tenant_id}'
    map:
      name: 'id'
      host: 'db_host'
      port: 'db_port'
      database: 'db_database'
      username: 'db_username'
      password: 'db_password'

  name:
    _state:
      type: string
  driver: 'postgres'
  charset: 'UTF8'

  host:
    _state:
      type: string
  port:
    _state:
      type: integer
  database:
    _state:
      type: string
  username:
    _state:
      type: string
  password:
    _state:
      type: string
