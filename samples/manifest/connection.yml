common:
  _state:
    type: map
  _store:
    client: InMemory
    key: "connection.common"
  _load:
    client: Env
    map:
      host: "DB_HOST"
      port: "DB_PORT"
      database: "DB_DATABASE"
      username: "DB_USERNAME"
      password: "DB_PASSWORD"

  host:
    _state:
      type: string
  port:
    _state:
      type: integer
  database:
    _state:
      type: string
  username:
    _state:
      type: string
  password:
    _state:
      type: string

tenant:
  _state:
    type: map
  _store:
    client: InMemory
    key: "connection.tenant.${tenant_id}"
  _load:
    client: DB
    connection: common
    table: "tenants"
    where: "id=${tenant_id}"
    map:
      host: "db_host"
      port: "db_port"
      database: "db_database"
      username: "db_username"
      password: "db_password"

  host:
    _state:
      type: string
  port:
    _state:
      type: integer
  database:
    _state:
      type: string
  username:
    _state:
      type: string
  password:
    _state:
      type: string
